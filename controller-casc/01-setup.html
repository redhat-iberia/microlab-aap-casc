<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Microlab SetUp :: Gestión del Ansible Automation Controller con Configuración como Código</title>
    <link rel="canonical" href="https://redhat-iberia.github.io/microlab-aap-casc/controller-casc/01-setup.html">
    <link rel="prev" href="index.html">
    <link rel="next" href="02-deploy.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img src="../_/img/RHDLogo.svg" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="https://redhat-iberia.github.io/microlab-aap-casc">Gestión del Ansible Automation Controller con Configuración como Código</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/kubernetes-tutorial/" target="_blank">Kubernetes</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/istio-tutorial/" target="_blank">Istio</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/tekton-tutorial/" target="_blank">Tekton</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="controller-casc" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html"></a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="01-setup.html">1. SetUp de Configuración como Código (CasC)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="02-deploy.html">2. Creación y eliminación de Job Templates con CasC y GitOps</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Gestión del Ansible Automation Controller con Configuración como Código</a></li>
    <li><a href="01-setup.html">1. SetUp de Configuración como Código (CasC)</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/redhat-iberia/microlab-aap-casc/edit/master/documentation/modules/ROOT/pages/01-setup.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Microlab SetUp</h1>
<div class="sect1">
<h2 id="_sistemas"><a class="anchor" href="#_sistemas"></a>Sistemas</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Para la realización de este microlab, hay que conectarse a través de un navegador web a los siguientes sistemas:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Sistemas de Administración</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Sistema</th>
<th class="tableblock halign-left valign-top">Elemento</th>
<th class="tableblock halign-left valign-top">Información</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ansible Automation Controller</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://aap24-controller01.sc24.workshops/#/login" class="bare">https://aap24-controller01.sc24.workshops/#/login</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ansible Automation Controller</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Usuario</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">user1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ansible Automation Controller</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contraseña</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Summit24!</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GitLab</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://gitlab.sc24.workshops:8888/root/sc24_casc" class="bare">https://gitlab.sc24.workshops:8888/root/sc24_casc</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GitLab</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Usuario</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">user1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GitLab</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contraseña</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Summit24!</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_casc_setup"><a class="anchor" href="#_casc_setup"></a>CasC Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Para poder entender cómo será el flujo y funcionamiento de nuestro Despliegue Continuo(CD) a través de Configuración como Código(CasC), debemos enteder previamente cómo se ha realizado el SetUp del mismo.</p>
</div>
<div class="paragraph">
<p>En la <a href="https://aap24-controller01.sc24.workshops/#/templates">interfaz web del Controller, sección Job Templates</a> veremos 3 Job Templates y un Workflow Job Template. Centrandonos en el SetUp del CasC, entremos en el detalle de superadmin WF_CasC_Ctrl y en la sección de Visualizer:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/wf_visualizer.png" alt="wf visualizer" width="600" height="400">
</div>
</div>
<div class="paragraph">
<p>En la imagen anterior podemos ver como este WorkFlow se encarcará de hacer un sync de nuestro projecto, posteriormente lanzará el JobTemplate de CD para crear y modificar los objetos definidos en nuestro Git y por último lanzará el JobTemplate de Dropdiff que eliminará lo que esté creado en el controller pero no definido en el repositorio Git.</p>
</div>
<div class="paragraph">
<p>Ahora podemos cerrar el Visualizer y centranos en la seción Details de este WorkFlow. Observaremos que el Webhook Service está habilitado para GitLab y que tenemos una Webhook URL y Webhook Key específica. Con esta información, podemos ahora revisar la configuración de nuestro Webhook en Gitlab.</p>
</div>
<div class="paragraph">
<p>En el <a href="https://gitlab.sc24.workshops:8888/root/sc24_casc">repositorio de git</a>, si nos vamos a settings &#8594; Webhooks vermos que hay un Webhook creado para eventos de push sobre todas las ramas. En este caso veremos que la URL es la que podiamos ver anteriormente desde el controller y el Secret token (aunque esté oculto) será el Token que igualmente veiamos en el controller:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/gitwebhook.png" alt="gitwebhook" width="600" height="400">
</div>
</div>
<div class="paragraph">
<p>Con esta configuración, lo que veremos durante el microlab es que ante un push en el repo Git, se ejecutará el WorkFlow del Controller al que, como acabamos de ver, nos hemos conectado.</p>
</div>
<div class="paragraph">
<p>Dicho esto esto, manos a la obra ;-)</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="index.html">Gestión del Ansible Automation Controller con Configuración como Código</a></span>
  <span class="next"><a href="02-deploy.html">2. Creación y eliminación de Job Templates con CasC y GitOps</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
